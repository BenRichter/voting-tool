<%- include('partials/head.ejs'); %>

<% if (!locals.loggedIn) { %>
    <a href="/auth">Login with GitHub</a>
<% } %>

<a href="#suggest-feature">Suggest a Feature</a>

<% locals.requests.forEach(request => { %>
<article>
    <aside>
        <p class="votes-count"><%= request.score %></p>
        <form method="post" action="/vote">
            <input type="hidden" name="request_id" value="<%= request.id %>">
            <input type="hidden" name="action" value="plus">
            <button type="submit">+</button>
        </form>
        <form method="post" action="/vote">
            <input type="hidden" name="request_id" value="<%= request.id %>">
            <input type="hidden" name="action" value="minus">
            <button type="submit">-</button>
        </form>
    </aside>
    <h1><a href="/r/<%= request.id %>"><%= request.title %></a></h1>
    <footer>Created <time datetime="<%= request.date %>"><%= request.dateRelative %></time> by <a href="https://github.com/<%= request.username %>"><%= request.username %></a></footer>
    <a href="/r/<%= request.id %>">
        <% if (request.comments.length > 0) { %><%= request.comments.length %><% } %>
    </a>
</article>
<% }) %>

<form method="post" action="/r/new" id="suggest-feature">
    <label for="title">Title</label>
    <input id="title" type="text" name="title">

    <label for="content">Description</label>
    <textarea id="content" name="content"></textarea>
    <button type="submit">Submit new request</button>
</form>
